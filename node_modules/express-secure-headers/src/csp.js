/*
|--------------------------------------------------------------------------
| Content-Security-Policy
|--------------------------------------------------------------------------
|
| The HTTP Content-Security-Policy response header allows web site 
| administrators to control resources the user agent is allowed to load for
| a given page. With a few exceptions, policies mostly involve specifying 
|Â server origins and script endpoints. This helps guard against cross-site 
| scripting attacks (XSS).
|
*/


/**
 * Handle an incoming request
 *
 * @param req
 * @param res
 * @param next
 */

module.exports = function (req,res,next) {
 
    res.setHeader('X-Content-Security-Policy' ,"default-src 'self'; script-src 'self'; object-src 'self'; style-src 'self'; img-src 'self' data:; media-src 'self'; frame-src 'self'; font-src 'self'; connect-src 'self'");

    res.setHeader('X-WebKit-CSP', "default-src 'self'; script-src 'self'; object-src 'self'; style-src 'self'; img-src 'self' data:; media-src 'self'; frame-src 'self'; font-src 'self'; connect-src 'self'");

    next();
 
 };
